!function(){for(var n=0,i=["ms","moz","webkit","o"],e=0;e<i.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[i[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[e]+"CancelAnimationFrame"]||window[i[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),a=Math.max(0,16-(e-n)),o=window.setTimeout(function(){i(e+a)},a);return n=e+a,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)}),window.RAF=window.requestAnimFrame=window.requestAnimationFrame}();
!function(){function t(){this.MST=0,this.MAT=300,this.fx="easeBoth",this.complete=function(){},this.moving=!1,this.infinity=!1,this.alternate=!1,this.repeats=0}var e=this,i=i||{};i.VERSION="v0.0.5",i.blendModes={NORMAL:0,ALPHA:1,ADD:2,MULTIPLY:3,SCREEN:4},i.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},i._UID=0,"undefined"!=typeof Float32Array?(i.Float32Array=Float32Array,i.Uint16Array=Uint16Array,i.Uint32Array=Uint32Array,i.ArrayBuffer=ArrayBuffer):console.log("%c not support WebGL ","color: #fff;background: #f00;"),i.PI_2=2*Math.PI,i.RTD=180/Math.PI,i.DTR=Math.PI/180,i.dontSpeek=!1,i.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0,autoResize:!1},i.sayHello=function(t){if(!i.dontSpeek){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["%c %c %c JC.js "+i.VERSION+" - "+t+"  %c  %c  http://www.JCjs.com/  %c %c ♥%c♥%c♥ ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,e)}i.dontSpeek=!0}},i.Point=function(t,e){this.x=t||0,this.y=e||0},i.Point.prototype.clone=function(){return new i.Point(this.x,this.y)},i.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},i.Point.prototype.constructor=i.Point,i.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},i.Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},i.Matrix.prototype.toArray=function(t){this.array||(this.array=new i.Float32Array(9));var e=this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0,e[8]=1),e},i.Matrix.prototype.apply=function(t,e){return e=e||new i.Point,e.x=this.a*t.x+this.c*t.y+this.tx,e.y=this.b*t.x+this.d*t.y+this.ty,e},i.Matrix.prototype.applyInverse=function(t,e){e=e||new i.Point;var r=1/(this.a*this.d+this.c*-this.b);return e.x=this.d*r*t.x+-this.c*r*t.y+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*t.y+-this.b*r*t.x+(-this.ty*this.a+this.tx*this.b)*r,e},i.Matrix.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},i.Matrix.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},i.Matrix.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,s=this.c,n=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=s*e-this.d*i,this.d=s*i+this.d*e,this.tx=n*e-this.ty*i,this.ty=n*i+this.ty*e,this},i.Matrix.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,s=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*s,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*s,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*s+this.ty,this},i.Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},i.identityMatrix=new i.Matrix,t.prototype.moveTween=function(t){this.MST=Date.now(),this.MATR=t.attr||this.MATR,this.MAT=t.time||this.MAT,this.fx=t.fx||this.fx,this.complete=t.complete||this.complete,this.infinity=t.infinity||this.infinity,this.alternate=t.alternate||this.alternate,this.repeats=t.repeats||this.repeats,this.moving=!0,this.MATRC={};for(var e in this.MATR)this.MATRC[e]=this[e]},t.prototype.manager=function(){if(this.moving){var t=Date.now();t<this.MST+this.MAT?this.nextPose():(this.setVal(this.MATR),this.repeats>0||this.infinity?(this.repeats>0&&--this.repeats,this.alternate?this.moveTween({attr:this.MATRC}):(this.setVal(this.MATRC),this.moveTween({attr:this.MATR}))):(this.moving=!1,this.complete(),t>this.MST&&(this.complete=function(){})))}},t.prototype.nextPose=function(){var t=Date.now()-this.MST;for(var e in this.MATR)this[e]=i.TWEEN[this.fx](t,this.MATRC[e],this.MATR[e]-this.MATRC[e],this.MAT)},i.DisplayObject=function(){t.call(this),this.visible=!0,this.worldAlpha=1,this.alpha=1,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.rotation=0,this.rotationCache=0,this._sr=0,this._cr=1,this.x=0,this.y=0,this.pivotX=0,this.pivotY=0,this._mask=null,this.parent=null,this.worldTransform=new i.Matrix,this.renderable=!1,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},i.DisplayObject.prototype=Object.create(t.prototype),i.DisplayObject.prototype.constructor=i.DisplayObject,Object.defineProperty(i.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(i.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),i.DisplayObject.prototype.setVal=function(t){if(void 0!==t)for(var e in t)void 0!==this[e]&&(this[e]=t[e])},i.DisplayObject.prototype.updateTransform=function(){var t,e,r,s,n,o,h=this.parent.worldTransform,a=this.worldTransform;this.rotation%i.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scaleX,e=this._sr*this.scaleX,r=-this._sr*this.scaleY,s=this._cr*this.scaleY,n=this.x,o=this.y,(this.pivotX||this.pivotY)&&(n-=this.pivotX*t+this.pivotY*r,o-=this.pivotX*e+this.pivotY*s),a.a=t*h.a+e*h.c,a.b=t*h.b+e*h.d,a.c=r*h.a+s*h.c,a.d=r*h.b+s*h.d,a.tx=n*h.a+o*h.c+h.tx,a.ty=n*h.b+o*h.d+h.ty):(t=this.scaleX,s=this.scaleY,n=this.x-this.pivotX*t,o=this.y-this.pivotY*s,a.a=t*h.a,a.b=t*h.b,a.c=s*h.c,a.d=s*h.d,a.tx=n*h.a+o*h.c+h.tx,a.ty=n*h.b+o*h.d+h.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this.manager()},i.DisplayObject.prototype.displayObjectUpdateTransform=i.DisplayObject.prototype.updateTransform,i.DisplayObject.prototype.getBounds=function(t){return t=t,i.EmptyRectangle},i.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(i.identityMatrix)},i.DisplayObject.prototype.generateTexture=function(t,e,r){var s=this.getLocalBounds(),n=new i.RenderTexture(0|s.width,0|s.height,r,e,t);return i.DisplayObject._tempMatrix.tx=-s.x,i.DisplayObject._tempMatrix.ty=-s.y,n.render(this,i.DisplayObject._tempMatrix),n},i.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},i.DisplayObject.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha,t.gl&&i.Sprite.prototype.render.call(this._cachedSprite,t)},i.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var e=new i.RenderTexture(0|t.width,0|t.height);this._cachedSprite=new i.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform}this._cacheAsBitmap=!0},i.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},i.DisplayObject.prototype.render=function(t){t=t},i.DisplayObject._tempMatrix=new i.Matrix,i.DisplayObjectContainer=function(){i.DisplayObject.call(this),this.children=[]},i.DisplayObjectContainer.prototype=Object.create(i.DisplayObject.prototype),i.DisplayObjectContainer.prototype.constructor=i.DisplayObjectContainer,i.DisplayObjectContainer.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},i.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},i.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);if(0>i||0>r)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=e,this.children[r]=t}},i.DisplayObjectContainer.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},i.DisplayObjectContainer.prototype.setChildIndex=function(t,e){if(0>e||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);this.children.splice(i,1),this.children.splice(e,0,t)},i.DisplayObjectContainer.prototype.getChildAt=function(t){if(0>t||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[t]},i.DisplayObjectContainer.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)},i.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},i.DisplayObjectContainer.prototype.removeChildren=function(t,e){var i=t||0,r="number"==typeof e?e:this.children.length,s=r-i;if(s>0&&r>=s){for(var n=this.children.splice(i,s),o=0;o<n.length;o++){var h=n[o];this.stage&&h.removeStageReference(),h.parent=void 0}return n}if(0===s&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},i.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform()}},i.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=i.DisplayObjectContainer.prototype.updateTransform,i.DisplayObjectContainer.prototype.render=function(t){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);var e,i;if(this._mask){for(this._mask&&t.maskManager.pushMask(this.mask,t),e=0,i=this.children.length;i>e;e++)this.children[e].render(t);this._mask&&t.maskManager.popMask(this._mask,t)}else for(e=0,i=this.children.length;i>e;e++)this.children[e].render(t)}},i.Sprite=function(t){i.DisplayObjectContainer.call(this),this.texture=t.texture,this.width=t.width||this.texture.width,this.height=t.height||this.texture.height,this.sH=t.sH||0,this.sW=t.sW||0,this.tint=16777215,this.blendMode=i.blendModes.NORMAL,this.shader=null,this.repeatX=t.repeatX||!1,this.repeatY=t.repeatY||!1,this.renderable=!0,this.buildMesh()},i.Sprite.prototype=Object.create(i.DisplayObjectContainer.prototype),i.Sprite.prototype.constructor=i.Sprite,i.Sprite.prototype.buildMesh=function(){var t=this.texture.width,e=this.texture.height;if(this.vertices=new i.Float32Array([-this.width/2,this.height/2,-this.width/2,-this.height/2,this.width/2,-this.height/2,this.width/2,this.height/2]),this.indices=new i.Uint16Array([0,1,2,0,2,3]),this.repeatX||this.repeatY){var r=this.repeatX?2:1,s=this.repeatY?2:1;this.uvs=new i.Float32Array([0*r,0*s,0*r,1*s,1*r,1*s,1*r,0*s])}else this.uvs=new i.Float32Array([this.sW/t,this.sH/e,this.sW/t,(this.sH+this.height)/e,(this.sW+this.width)/t,(this.sH+this.height)/e,(this.sW+this.width)/t,this.sH/e]);this.cachedTint=this.tint||16777215,this.dirty=!0},i.Sprite.prototype.createBuffer=function(t){this.vertexBuffer=t.createBuffer(),this.uvsBuffer=t.createBuffer(),this.indicesBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ARRAY_BUFFER,this.uvsBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this.dirty=!1},i.Sprite.prototype.syncUniforms=function(t){var e=t.gl,r=t.shaderManager.shader,s=t.projection;e.uniform1i(r.uSampler,0),e.uniform1f(r.uAlpha,this.worldAlpha),e.uniform2f(r.projectionVector,s.x,s.y),e.uniformMatrix3fv(r.uMatrix,!1,this.worldTransform.toArray(!0)),e.uniform3fv(r.uTint,i.hex2rgb(this.tint))},i.Sprite.prototype.syncAttribute=function(t){var e=t.gl,i=t.shaderManager.shader;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.enableVertexAttribArray(i.aVertexPosition),e.vertexAttribPointer(i.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.uvsBuffer),e.enableVertexAttribArray(i.aTextureCoord),e.vertexAttribPointer(i.aTextureCoord,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)},i.Sprite.prototype.upDate=function(t){t.texturesManager.setTexture(this.texture),this.dirty&&this.createBuffer(t.gl),this.syncAttribute(t),this.syncUniforms(t)},i.Sprite.prototype.render=function(t){if(this.visible&&!(this.alpha<=0)){this.upDate(t);var e,i,r=t.gl;if(this._mask){for(this._mask&&t.maskManager.pushMask(this.mask,t),r.drawElements(r.TRIANGLES,this.indices.length,r.UNSIGNED_SHORT,0),e=0,i=this.children.length;i>e;e++)this.children[e].render(t);this._mask&&t.maskManager.popMask(this._mask,t)}else for(r.drawElements(r.TRIANGLES,this.indices.length,r.UNSIGNED_SHORT,0),e=0,i=this.children.length;i>e;e++)this.children[e].render(t)}},i.Sprite.fromFrame=function(t){var e=i.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new i.Sprite(e)},i.Sprite.fromImage=function(t,e,r){var s=i.Texture.fromImage(t,e,r);return new i.Sprite(s)},i.Stage=function(t){i.DisplayObjectContainer.call(this),this.worldTransform=new i.Matrix,this.interactive=!0,this.dirty=!0,this.stage=this,this.setBackgroundColor(t)},i.Stage.prototype=Object.create(i.DisplayObjectContainer.prototype),i.Stage.prototype.constructor=i.Stage,i.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform()},i.Stage.prototype.setBackgroundColor=function(t){"number"!=typeof t&&(this.backgroundColor=i.hex2rgb(t))},i.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},i.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){return function(t){function e(){for(var r=arguments.length,n=new Array(r);r--;)n[r]=arguments[r];return n=s.concat(n),i.apply(this instanceof e?this:t,n)}var i=this,r=arguments.length-1,s=[];if(r>0)for(s.length=r;r--;)s[r]=arguments[r+1];if("function"!=typeof i)throw new TypeError;return e.prototype=function n(t){return t&&(n.prototype=t),this instanceof n?void 0:new n}(i.prototype),e}}()),i.getNextPowerOfTwo=function(t){if(t>0&&0===(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},i.isPowerOfTwo=function(t,e){return t>0&&0===(t&t-1)&&e>0&&0===(e&e-1)},i.CompileVertexShader=function(t,e){return i._CompileShader(t,e,t.VERTEX_SHADER)},i.CompileFragmentShader=function(t,e){return i._CompileShader(t,e,t.FRAGMENT_SHADER)},i._CompileShader=function(t,e,i){var r=e.join("\n"),s=t.createShader(i);return t.shaderSource(s,r),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS)?s:(window.console.log(t.getShaderInfoLog(s)),null)},i.compileProgram=function(t,e,r){var s=i.CompileFragmentShader(t,r),n=i.CompileVertexShader(t,e),o=t.createProgram();return t.attachShader(o,n),t.attachShader(o,s),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),o},i.SpriteShader=function(t){this._UID=i._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","uniform sampler2D uSampler;","uniform vec3 uTint;","uniform float uAlpha;","void main(void) {","   vec4 smpColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor = vec4(uTint,uAlpha) * smpColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform vec2 projectionVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","void main(void) {","   vec2 v = ( uMatrix * vec3(aVertexPosition , 1.0) ).xy ;","   gl_Position = vec4( v / projectionVector , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.textureCount=0,this.init()},i.SpriteShader.prototype.constructor=i.SpriteShader,i.SpriteShader.prototype.init=function(){var t=this.gl,e=i.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.uMatrix=t.getUniformLocation(e,"uMatrix"),this.uTint=t.getUniformLocation(e,"uTint"),this.uAlpha=t.getUniformLocation(e,"uAlpha"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.program=e},i.SpriteShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null},i.Renderer=function(t,e,r){if(r)for(var s in i.defaultRenderOptions)"undefined"==typeof r[s]&&(r[s]=i.defaultRenderOptions[s]);else r=i.defaultRenderOptions;this.resolution=r.resolution||window.devicePixelRatio,this.transparent=r.transparent,this.autoResize=r.autoResize||!1,this.clearBeforeRender=r.clearBeforeRender||!0,this.width=t||800,this.height=e||600,this.view=r.view||document.createElement("canvas"),this.contextLostBound=this.handleContextLost.bind(this),this.contextRestoredBound=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLostBound,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredBound,!1),this._contextOptions={alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer},this.projection=new i.Point,this.offset=new i.Point(0,0),this.shaderManager=new i.ShaderManager,this.texturesManager=new i.TexturesManager,this.maskManager=new i.WebGLMaskManager,this.blendModeManager=new i.WebGLBlendModeManager,this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.shaderManager=this.shaderManager,this.renderSession.texturesManager=this.texturesManager,this.renderSession.maskManager=this.maskManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.renderer=this,this.renderSession.resolution=this.resolution,this.initContext(),this.mapBlendModes()},i.Renderer.prototype.constructor=i.Renderer,i.Renderer.prototype.initContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=t,!t)throw new Error("This browser does not support webGL. Try using the canvas renderer");t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),this.shaderManager.setContext(t),this.texturesManager.setContext(t),this.maskManager.setContext(t),this.blendModeManager.setContext(t),this.renderSession.gl=this.gl,this.resize(this.width,this.height)},i.Renderer.prototype.render=function(t){if(!this.contextLost){t.updateTransform();var e=this.gl;this.clearBeforeRender&&(this.transparent?e.clearColor(0,0,0,0):e.clearColor(t.backgroundColor[0],t.backgroundColor[1],t.backgroundColor[2],1),e.clear(e.COLOR_BUFFER_BIT)),this.renderDisplayObject(t,this.projection)}},i.Renderer.prototype.renderDisplayObject=function(t,e,r){this.renderSession.blendModeManager.setBlendMode(i.blendModes.NORMAL),this.renderSession.projection=e,this.renderSession.offset=this.offset,t.render(this.renderSession)},i.Renderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=this.height/2/this.resolution},i.Renderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},i.Renderer.prototype.handleContextRestored=function(){this.initContext();for(var t in i.TextureCache){var e=i.TextureCache[t].baseTexture;e._glTextures=[]}this.contextLost=!1},i.Renderer.prototype.mapBlendModes=function(){var t=this.gl;i.blendModesWebGL||(i.blendModesWebGL=[],i.blendModesWebGL[i.blendModes.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.ALPHA]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.ADD]=[t.SRC_ALPHA,t.DST_ALPHA],i.blendModesWebGL[i.blendModes.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],i.blendModesWebGL[i.blendModes.SCREEN]=[t.SRC_ALPHA,t.ONE])},i.TexturesManager=function(){this.textures={}},i.TexturesManager.prototype.constructor=i.TexturesManager,i.TexturesManager.prototype.setContext=function(t){this.gl=t,this._UNITS=0},i.TexturesManager.prototype.setTexture=function(t){var e=this.gl;return this.currentId===t.id?!1:(void 0===this.textures[t.id]&&this.setPara(t),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.textures[t.id].texture),this.currentId=t.id,!0)},i.TexturesManager.prototype.setPara=function(t){var e=this.gl;t.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,t.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.img),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),t.unit=this._UNITS,this.textures[t.id]=t,e.bindTexture(e.TEXTURE_2D,null),this._UNITS++},i.TexturesManager.prototype.destroy=function(){this.gl=null},i.WebGLBlendModeManager=function(){this.currentBlendMode=99999},i.WebGLBlendModeManager.prototype.constructor=i.WebGLBlendModeManager,i.WebGLBlendModeManager.prototype.setContext=function(t){this.gl=t},i.WebGLBlendModeManager.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var e=i.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(e[0],e[1]),!0},i.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},i.ShaderManager=function(){this.shaders={}},i.ShaderManager.prototype.constructor=i.ShaderManager,i.ShaderManager.prototype.setContext=function(t){this.gl=t,this.shaders.sprite=new i.SpriteShader(t),this.setShader("sprite")},i.ShaderManager.prototype.setShader=function(t){return this._curShaderType===t?!1:(this._curShaderType=t,this.shader=this.shaders[t],this.gl.useProgram(this.shader.program),!0)},i.ShaderManager.prototype.destroy=function(){this.gl=null},i.WebGLMaskManager=function(){},i.WebGLMaskManager.prototype.constructor=i.WebGLMaskManager,i.WebGLMaskManager.prototype.setContext=function(t){this.gl=t},i.WebGLMaskManager.prototype.pushMask=function(t,e){var i=e.gl;i.enable(i.STENCIL_TEST),i.depthMask(!1),i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.ALWAYS,1,-1),i.stencilOp(i.KEEP,i.REPLACE,i.REPLACE),i.depthMask(!0),i.colorMask(!0,!0,!0,!0),i.stencilFunc(i.EQUAL,1,-1),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)},i.WebGLMaskManager.prototype.popMask=function(){var t=this.gl;t.disable(t.STENCIL_TEST)},i.WebGLMaskManager.prototype.destroy=function(){this.gl=null},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=i),exports.JC=i):"undefined"!=typeof define&&define.amd?define(i):e.JC=i}(this);
!function(){window.JC=window.JC||{},JC.Texture=function(i,t){this.id=i,this.img=t,this.width=t.width,this.height=t.height},JC.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},JC.TextureCache={},JC.ImageLoader=function(i,t){this.receiveNum=0,this.failNum=0,this.requestNum=0,this.crossorigin=t,this.sources=i||{},this.imgs={},this.loading()},JC.ImageLoader.prototype.constructor=JC.ImageLoader,JC.ImageLoader.prototype.loading=function(){function i(i,e){e.onload=function(){t.receiveNum++,JC.TextureCache[i]=new JC.Texture(i,e),t.receiveNum+t.failNum>=t.requestNum&&(t.onLoaded(),t.failNum>0&&t.onFailed())},e.onerror=function(){t.failNum++}}var t=this;for(var e in this.sources)this.imgs[e]=new Image,i(e,this.imgs[e]),this.crossorigin&&(this.imgs[e].crossOrigin=""),this.imgs[e].src=this.sources[e],this.requestNum++},JC.ImageLoader.prototype.getTexture=function(i){return JC.TextureCache[i]},JC.ImageLoader.prototype.onLoaded=function(){},JC.ImageLoader.prototype.onFailed=function(){}}();
!function(){window.JC=window.JC||{},JC.TWEEN={easeBoth:function(n,i,t,e){return(n/=e/2)<1?t/2*n*n+i:-t/2*(--n*(n-2)-1)+i},extend:function(n){if(n)for(var i in n)"extend"!==i&&n[i]&&(this[i]=n[i])}}}();
//# sourceMappingURL=../maps/jcw2d.js.map
